{"id":"80e8121b-c426-4bb9-866e-faf06af2c398","name":"Module In-place Refresh","description":"Can be used to start from an existing OS to perform a wipe-and-load","versions":[{"id":"108d5d68-1a13-4ec1-aafa-f52846e20651","taskSequenceId":"80e8121b-c426-4bb9-866e-faf06af2c398","versionNo":1,"status":"Active","description":"","steps":[{"id":"de52cc18-00da-4056-f45e-08dde0c158e0","taskSequenceVersionId":"108d5d68-1a13-4ec1-aafa-f52846e20651","name":"In-place Refresh","description":"This module is designed to start from a full Windows OS and can be called from an existing OSD task sequence.","typeId":null,"type":null,"stepDefinitionVersionId":null,"stepDefinitionVersionNo":null,"typeVersion":null,"groupId":null,"groupMembers":[{"id":"47ab6cb0-561a-4856-4e74-08dde0d78d18","taskSequenceVersionId":null,"name":"Set Deployment Type","description":"","typeId":"00000001-0000-0000-0000-000000000001","type":null,"stepDefinitionVersionId":"ba5a045d-2392-4ad1-f8ba-08dc9ff6a5e9","stepDefinitionVersionNo":1,"typeVersion":null,"groupId":"de52cc18-00da-4056-f45e-08dde0c158e0","groupMembers":[],"settings":{"VariableName":"DeploymentType","VariableValue":"REFRESH"},"contentItems":{},"isGroup":false,"continueOnError":false,"enabled":true,"condition":"","createdDate":1755825053,"lastModifiedDate":1755825053},{"id":"f62e9429-c9b2-43dd-4e76-08dde0d78d18","taskSequenceVersionId":null,"name":"Suspend BitLocker","description":"","typeId":"00000001-0000-0000-0000-000000000002","type":null,"stepDefinitionVersionId":"5f666533-9e61-407c-f8bb-08dc9ff6a5e9","stepDefinitionVersionNo":1,"typeVersion":null,"groupId":"de52cc18-00da-4056-f45e-08dde0c158e0","groupMembers":[],"settings":{"ScriptName":"","Script":"Suspend-BitLocker -MountPoint \"C:\" -RebootCount 0","Parameters":""},"contentItems":{"Content":""},"isGroup":false,"continueOnError":false,"enabled":true,"condition":"get-ciminstance -Namespace root\\cimv2\\Security\\MicrosoftVolumeEncryption -Query \"select * from Win32_EncryptableVolume where driveletter = '$env:systemdrive' and protectionstatus = '1'\"","createdDate":1755825053,"lastModifiedDate":1755825053},{"id":"43af5bb7-760f-4ac7-f460-08dde0c158e0","taskSequenceVersionId":null,"name":"Reboot","description":"","typeId":"00000001-0000-0000-0000-000000000007","type":null,"stepDefinitionVersionId":"df9e5075-5038-4462-87ae-e46b12907570","stepDefinitionVersionNo":1,"typeVersion":null,"groupId":"de52cc18-00da-4056-f45e-08dde0c158e0","groupMembers":[],"settings":{"RebootRequested":"WinPE","RebootMessage":"","RebootDelay":"0","ScriptName":"Reboot.ps1"},"contentItems":{"Content":"00000000-0000-0000-0000-000000000002:1"},"isGroup":false,"continueOnError":false,"enabled":true,"condition":"","createdDate":1755825053,"lastModifiedDate":1755825053}],"settings":{},"contentItems":{},"isGroup":true,"continueOnError":false,"enabled":true,"condition":"{\"operator\":\"and\",\"items\":[{\"field\":\"OSVERSION\",\"operator\":\"notEquals\",\"value\":\"WinPE\"}]}","createdDate":1755825053,"lastModifiedDate":1755825053},{"id":"325ea703-a434-4c60-4e75-08dde0d78d18","taskSequenceVersionId":"108d5d68-1a13-4ec1-aafa-f52846e20651","name":"Prepare Refresh Scenario","description":"","typeId":"00000001-0000-0000-0000-000000000002","type":null,"stepDefinitionVersionId":"5f666533-9e61-407c-f8bb-08dc9ff6a5e9","stepDefinitionVersionNo":1,"typeVersion":null,"groupId":null,"groupMembers":[],"settings":{"ScriptName":"","Script":"$state = \"X:\\_2P\\state\"\r\nif (-not (test-path $state)) {new-item -path $state -itemtype directory}\r\n$logs = \"X:\\_2P\\logs\"\r\nif (-not (test-path $logs)) {new-item -path $logs -itemtype directory}\r\nCopy-Item C:\\_2P\\state\\* X:\\_2P\\state -Recurse -Force\r\nCopy-Item C:\\_2P\\logs\\* X:\\ -Recurse -Force\r\n$tsenv:DEPLOYRROOT = \"X:\\_2P\"\r\n$tsenv:DEPLOYRSTATE = \"X:\\_2P\\state\"\r\n$tsenv:_DEPLOYRLOGS = \"X:\\_2P\\logs\"","Parameters":""},"contentItems":{"Content":""},"isGroup":false,"continueOnError":false,"enabled":true,"condition":"{\"operator\":\"and\",\"items\":[{\"field\":\"DeploymentType\",\"operator\":\"equals\",\"value\":\"REFRESH\"},{\"field\":\"OSVERSION\",\"operator\":\"equals\",\"value\":\"WinPE\"}]}","createdDate":1755825053,"lastModifiedDate":1755825053}],"createdDate":1755825053,"lastModifiedDate":1755825053}],"versionsCount":0,"createdDate":1755825053,"lastModifiedDate":1755926054,"architecture":"Any"}
